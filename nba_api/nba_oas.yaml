openapi: 3.0.1
info:
  title: NBA API
  description: API for retrieving NBA teams, matches, players, and their statistics
  version: 1.0.0
paths:
  /teams:
    get:
      summary: Retrieve all teams by ticker and season
      parameters:
        - in: query
          name: team_tickers
          schema:
            type: array
            items:
              type: string
          required: true
          description: List of team tickers
          example: ["BOS", "LAL", "MIA"]
        - in: query
          name: season
          schema:
            type: string
          required: true
          description: NBA season (e.g., 2023-24)
          example: "2023-24"
      responses:
        '200':
          description: A list of teams with their information and players
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Team'

  /teams/{team_ticker}:
    get:
      summary: Retrieve team information and players by ticker and season
      parameters:
        - in: path
          name: team_ticker
          schema:
            type: string
          required: true
          description: Team ticker
          example: "BOS"
        - in: query
          name: season
          schema:
            type: string
          required: true
          description: NBA season (e.g., 2023-24)
          example: "2023-24"
      responses:
        '200':
          description: Team information and list of players
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Team'

  /teams/{team_id}/stats:
    get:
      summary: Retrieve team stats by team ID, season, date, number of games, and location
      parameters:
        - in: path
          name: team_id
          schema:
            type: integer
          required: true
          description: Team ID
          example: 1610612738
        - in: query
          name: season
          schema:
            type: string
          required: true
          description: NBA season (e.g., 2023-24)
          example: "2023-24"
        - in: query
          name: date_to
          schema:
            type: string
            format: date
          required: true
          description: Match date up to consider for the stats (format:'YYYY-MM-DD')
          example: "2024-08-08"
        - in: query
          name: last_x
          schema:
            type: integer
          required: false
          description: Number of last games to consider
          example: 5
        - in: query
          name: home_away_filter
          schema:
            type: string
          required: false
          description: Location of the games (HOME or AWAY)
          example: "HOME"
      responses:
        '200':
          description: A list of team stats
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TeamStats'

  /matches:
    get:
      summary: Retrieve all matches beetween two dates
      parameters:
        - in: query
          name: date_from
          schema:
            type: string
          required: true
          description: The cutoff date from which games are considered (format:'YYYY-MM-DD')
          example: "2024-04-14"
        - in: query
          name: date_to
          schema:
            type: string
          required: false
          description: The cutoff date until which games are considered (format:'YYYY-MM-DD')
          example: "2024-04-14"
      responses:
        '200':
          description: A list of matches
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Match'

  /match/{match_id}/stats:
    get:
      summary: Retrieve match stats by match ID
      parameters:
        - in: path
          name: match_id
          schema:
            type: string
          required: true
          description: Match ID
          example: "0022301187"
        - in: query
          name: match_date
          schema:
            type: string
          required: true
          description: The date of the match (format:'YYYY-MM-DD')
          example: "2024-04-14"
      responses:
        '200':
          description: Match stats
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MatchStats'

  /players/{player_id}/stats:
    get:
      summary: Retrieve player stats by player ID, season, date, location and number of games
      parameters:
        - in: path
          name: player_id
          schema:
            type: string
          required: true
          description: Player ID
          example: "1629027"
        - in: query
          name: season
          schema:
            type: string
          required: true
          description: NBA season (e.g., 2023-24)
          example: "2023-24"
        - in: query
          name: date_to
          schema:
            type: string
            format: date
          required: true
          description: Match date up to consider for the stats (format:'YYYY-MM-DD')
          example: "2024-08-08"
        - in: query
          name: last_x
          schema:
            type: integer
          required: false
          description: Number of last games to consider
          example: 5
        - in: query
          name: home_away_filter
          schema:
            type: string
          required: false
          description: Location of the games (HOME or AWAY)
          example: "HOME"
      responses:
        '200':
          description: Player stats
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlayerStats'
  /feature_vector:
    get:
      summary: Retrieve feature vector 
      operationId: feature_vector_get
      parameters:
        - name: team_ticker
          in: query
          description: Team ticker
          required: true
          style: form
          explode: false
          schema:
            type: string
          example: BOS
        - name: opp_team_ticker
          in: query
          description: Opposite team ticker
          required: true
          style: form
          explode: false
          schema:
            type: string
          example: BOS
        - name: season
          in: query
          description: "NBA season (e.g., 2023-24)"
          required: true
          style: form
          explode: true
          schema:
            type: string
          example: 2023-24
        - name: date
          in: query
          description: Date of the match (format:'YYYY-MM-DD')
          required: true
          style: form
          explode: true
          schema:
            type: string
          example: 2024-04-14
      responses:
        "200":
          description: Feature vector
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FeatureVector'
      x-openapi-router-controller: swagger_server.controllers.feature_vector_controller
components:
  schemas:
    Team:
      type: object
      properties:
        team_ticker:
          type: string
          example: "BOS"
        team_info:
          $ref: '#/components/schemas/TeamInfo'
        team_players:
          type: array
          items:
            $ref: '#/components/schemas/Player'

    TeamInfo:
      type: object
      properties:
        id:
          type: integer
          example: 1610612738
        full_name:
          type: string
          example: "Boston Celtics"
        abbreviation:
          type: string
          example: "BOS"
        nickname:
          type: string
          example: "Celtics"
        city:
          type: string
          example: "Boston"
        state:
          type: string
          example: "MA"
        year_founded:
          type: integer
          example: 1946
        arena:
          type: string
          example: "TD Garden"

    Player:
      type: object
      properties:
        player_id:
          type: integer
          example: 1630552
        player:
          type: string
          example: "Marcus Smart"
        num:
          type: string
          example: "36"
        position:
          type: string
          example: "G"
        height:
          type: string
          example: "6-3"
        weight:
          type: integer
          example: 220
        age:
          type: number
          example: 29
        exp:
          type: string
          example: "6"

    TeamStats:
      type: object
      properties:
        all_stats:
          type: array
          items:
            $ref: '#/components/schemas/TeamMatchStat'
        totals:
          type: object
          items:
            properties:
              wins:
                type: integer
                example: 2
              losses:
                type: integer
                example: 3
        average:
          $ref: '#/components/schemas/Average'
       
       
    AveragePlayer:
      allOf:
        - $ref: '#/components/schemas/Average'
        - type: object
          properties:
            plus_minus:
                type: number
                example: -2.2
            
    Average:
          type: object
          items:
            properties:
              fgm:
                type: integer
                example: 40.4
              fga:
                type: integer
                example: 85.5
              fg_pct:
                type: number
                example: 0.4367
              fg3m:
                type: number
                example: 12.2
              fg3a:
                type: number
                example: 32.0
              fg3_pct:
                type: number
                example: 0.4367
              ftm:
                type: number
                example: 18.3
              fta:
                type: number
                example: 22.0
              ft_pct:
                type: number
                example: 0.4367
              oreb:
                type: number
                example: 10.1
              dreb:
                type: number
                example: 35.8
              reb:
                type: number
                example: 45.9
              ast:
                type: number
                example: 25
              stl:
                type: number
                example: 8.4
              blk:
                type: number
                example: 5.4
              tov:
                type: number
                example: 13.4
              pf:
                type: number
                example: 20.0
              pts:
                type: number
                example: 16.4

    Match:
      type: object
      properties:
        match_up:
          type: string
          example: "CLE vs. CHA"
        game_id:
          type: string
          example: "0022301187"
        date:
          type: string
          format: date
          example: "2024-04-14"
        home_team:
          $ref: '#/components/schemas/TeamInfo'
        away_team:
          $ref: '#/components/schemas/TeamInfo'
        referee:
          $ref: '#/components/schemas/Referee'
          
    Referee:
      type: object
      properties:
        name:
          type: string
          example: "Sean Corbin"
        id:
          type: integer
          example: 1151

    MatchStats:
      type: object
      properties:
        actual_match_stats:
          type: array
          items:
            $ref: '#/components/schemas/ActualMatchStats'
        last_match_stats:
          type: array
          items:
            $ref: '#/components/schemas/LastMatchStats'

    GlobalStats:
      type: object
      properties:
        game_id:
          type: string
          example: "0022301198"
        game_date:
          type: string
          format: date
          example: "2024-04-14"
        match_up:
          type: string
          example: "GSW vs. UTA"
        winner:
          type: string
          example: "GSW"
        home_point:
          type: integer
          example: 123
        away_point:
          type: integer
          example: 116

    ActualMatchStats:
      type: object
      properties:
        global_stats:
          $ref: '#/components/schemas/GlobalStats'
        by_home_stats:
          $ref: '#/components/schemas/Stat'
        by_away_stats:
          $ref: '#/components/schemas/Stat'

    LastMatchStats:
      type: object
      properties:
        global_stats:
          type: array
          items:
            $ref: '#/components/schemas/GlobalStats'
        by_home_stats:
          type: array
          items:
            $ref: '#/components/schemas/Stat'
        by_away_stats:
          type: array
          items:
            $ref: '#/components/schemas/Stat'
         
    TeamMatchStat:
      type: object
      properties:
        team_id:
          type: integer
          example: 1610612738
        team_abbreviation:
          type: string
          example: "BOS"
        team_name:
          type: string
          example: "Boston Celtics"
        game_id:
          type: string
          example: "0022001074"
        game_date:
          type: string
          format: date
          example: "2024-01-23"
        match_up:
          type: string
          example: "BOS vs. LAL"
        wl:
          type: string
          example: "W"
        w:
          type: integer
          example: 36
        l:
          type: integer
          example: 44
        w_pct:
          type: number
          example: 0.45
        min:
          type: integer
          example: 240
        fgm:
          type: integer
          example: 40
        fga:
          type: integer
          example: 85
        fg_pct:
          type: number
          example: 47.1
        fg3m:
          type: integer
          example: 12
        fg3a:
          type: integer
          example: 32
        fg3_pct:
          type: number
          example: 37.5
        ftm:
          type: integer
          example: 18
        fta:
          type: integer
          example: 22
        ft_pct:
          type: number
          example: 81.8
        oreb:
          type: integer
          example: 10
        dreb:
          type: integer
          example: 35
        reb:
          type: integer
          example: 45
        ast:
          type: integer
          example: 25
        stl:
          type: integer
          example: 8
        blk:
          type: integer
          example: 5
        tov:
          type: integer
          example: 13
        pf:
          type: integer
          example: 20
        pts:
          type: integer
          example: 110
          
    Stat:
      type: object
      properties:
        season_id:
          type: string
          example: "22023"
        team_id:
          type: integer
          example: 1610612738
        team_abbreviation:
          type: string
          example: "BOS"
        team_name:
          type: string
          example: "Boston Celtics"
        game_id:
          type: string
          example: "0022001074"
        game_date:
          type: string
          format: date
          example: "2024-01-23"
        match_up:
          type: string
          example: "BOS vs. LAL"
        wl:
          type: string
          example: "W"
        min:
          type: integer
          example: 240
        fgm:
          type: integer
          example: 40
        fga:
          type: integer
          example: 85
        fg_pct:
          type: number
          example: 47.1
        fg3m:
          type: integer
          example: 12
        fg3a:
          type: integer
          example: 32
        fg3_pct:
          type: number
          example: 37.5
        ftm:
          type: integer
          example: 18
        fta:
          type: integer
          example: 22
        ft_pct:
          type: number
          example: 81.8
        oreb:
          type: integer
          example: 10
        dreb:
          type: integer
          example: 35
        reb:
          type: integer
          example: 45
        ast:
          type: integer
          example: 25
        stl:
          type: integer
          example: 8
        blk:
          type: integer
          example: 5
        tov:
          type: integer
          example: 13
        pf:
          type: integer
          example: 20
        pts:
          type: integer
          example: 110
        plus_minus:
          type: number
          example: -6
        video_available:
          type: number
          example: 1

    PlayerStats:
      type: object
      properties:
        all_stats:
          type: array
          items:
            $ref: '#/components/schemas/PlayerMatchStats'
        totals:
          type: object
          items:
            properties:
              wins:
                type: integer
                example: 2
              losses:
                type: integer
                example: 3
        average:
          $ref: '#/components/schemas/AveragePlayer'
        player_efficiency:
          type: object
          items:
            properties:
              all:
                type: number
                example: 19.5192
              filtered_matches:
                type: number
                example: 14.6

    PlayerMatchStats:
      type: object
      properties:
        season_id:
          type: string
          example: "22023"
        player_id:
          type: integer
          example: 203507
        game_id:
          type: string
          example: "0022001074"
        game_date:
          type: string
          format: date
          example: "APR 10, 2024"
        match_up:
          type: string
          example: "BOS vs. LAL"
        wl:
          type: string
          example: "W"
        min:
          type: number
          example: 36
        fgm:
          type: number
          example: 8
        fga:
          type: number
          example: 15
        fg_pct:
          type: number
          example: 53.3
        fg3m:
          type: number
          example: 4
        fg3a:
          type: number
          example: 9
        fg3_pct:
          type: number
          example: 44.4
        ftm:
          type: number
          example: 2
        fta:
          type: number
          example: 2
        ft_pct:
          type: number
          example: 100
        oreb:
          type: number
          example: 1
        dreb:
          type: number
          example: 4
        reb:
          type: number
          example: 5
        ast:
          type: number
          example: 7
        stl:
          type: number
          example: 2
        blk:
          type: number
          example: 1
        tov:
          type: number
          example: 3
        pf:
          type: number
          example: 4
        pts:
          type: number
          example: 22
        plus_minus:
          type: number
          example: -6
        video_available:
          type: number
          example: 1
    FeatureVector:
      type: object
      properties:
        fg_pct_H:
          type: number
          format: float
          description: Field goal percentage for the home team
        fg3_pct_H:
          type: number
          format: float
          description: Three-point field goal percentage for the home team
        ft_pct_H:
          type: number
          format: float
          description: Free throw percentage for the home team
        reb_H:
          type: integer
          description: Total rebounds for the home team
        tot_ast_H:
          type: integer
          description: Total assists for the home team
        tot_tov_H:
          type: integer
          description: Total turnovers for the home team
        tot_stl_H:
          type: integer
          description: Total steals for the home team
        tot_blk_H:
          type: integer
          description: Total blocks for the home team
        ts_pct_H:
          type: number
          format: float
          description: True shooting percentage for the home team
        w_pct_H:
          type: number
          format: float
          description: Winning percentage for the home team
        w_pct_last_5_games_H:
          type: number
          format: float
          description: Winning percentage in the last 5 games for the home team
        fg_pct_A:
          type: number
          format: float
          description: Field goal percentage for the away team
        fg3_pct_A:
          type: number
          format: float
          description: Three-point field goal percentage for the away team
        ft_pct_A:
          type: number
          format: float
          description: Free throw percentage for the away team
        reb_A:
          type: integer
          description: Total rebounds for the away team
        tot_ast_A:
          type: integer
          description: Total assists for the away team
        tot_tov_A:
          type: integer
          description: Total turnovers for the away team
        tot_stl_A:
          type: integer
          description: Total steals for the away team
        tot_blk_A:
          type: integer
          description: Total blocks for the away team
        ts_pct_A:
          type: number
          format: float
          description: True shooting percentage for the away team
        w_pct_A:
          type: number
          format: float
          description: Winning percentage for the away team
        w_pct_last_5_games_A:
          type: number
          format: float
          description: Winning percentage in the last 5 games for the away team
        off_rating_H:
          type: number
          format: float
          description: Offensive rating for the home team
        def_rating_H:
          type: number
          format: float
          description: Defensive rating for the home team
        off_rating_A:
          type: number
          format: float
          description: Offensive rating for the away team
        def_rating_A:
          type: number
          format: float
          description: Defensive rating for the away team
        lineup_efficiency_H:
          type: number
          format: float
          description: Lineup efficiency for the home team
        lineup_efficiency_A:
          type: number
          format: float
          description: Lineup efficiency for the away team
        home_team:
          type: string
          description: Home team code
        away_team:
          type: string
          description: Away team code
        game_id:
          type: string
          description: Unique identifier for the game
        winner:
          type: string
          description: Indicates which team won the game ('home' or 'away')
        pts_H:
          type: integer
          description: Points scored by the home team
        pts_A:
          type: integer
          description: Points scored by the away team
        season:
          type: string
          description: Season year
        date:
          type: string
          format: date
          description: Date of the game
        playoff:
          type: boolean
          description: Indicates if the game was a playoff game
        referee_name:
          type: string
          description: Name of the referee
        referee_id:
          type: integer
          description: Identifier of the referee
      example:
        fg_pct_H: 0.4762320104666376
        fg3_pct_H: 0.3521515988945914
        ft_pct_H: 0.7569339384770549
        reb_H: 3426
        tot_ast_H: 1996
        tot_tov_H: 1119
        tot_stl_H: 658
        tot_blk_H: 418
        ts_pct_H: 0.5769836109563027
        w_pct_H: 0.568
        w_pct_last_5_games_H: 0.4
        fg_pct_A: 0.4883753306417931
        fg3_pct_A: 0.37350565428109855
        ft_pct_A: 0.7723283427981414
        reb_A: 3588
        tot_ast_A: 2160
        tot_tov_A: 998
        tot_stl_A: 548
        tot_blk_A: 409
        ts_pct_A: 0.6015969574177876
        w_pct_A: 0.605
        w_pct_last_5_games_A: 0.4
        off_rating_H: 112.91448516579408
        def_rating_H: 110.76233183856503
        off_rating_A: 117.6130198915009
        def_rating_A: 115.03496503496504
        lineup_efficiency_H: 11.921331417624522
        lineup_efficiency_A: 13.659979368814922
        home_team: "ORL"
        away_team: "MIL"
        game_id: "0022301191"
        winner: "home"
        pts_H: 113
        pts_A: 88
        season: "2023-24"
        date: "2024-04-14"
        playoff: false
        referee_name: "Brent Barnaky"
        referee_id: 201638       